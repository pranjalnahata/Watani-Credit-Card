<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <!-- <link rel="shortcut icon" type="image/png" href="./assets/Behrouz-Logo.png" /> -->
  <title>Watani Credit Card</title>
  <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/dist/mindar-image.prod.js"></script>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
  <!-- <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.5/dist/mindar-image-aframe.prod.js"></script> -->

  <style>
    body {
      margin: 0;
    }

    .example-container {
      overflow: hidden;
      position: absolute;
      width: 100%;
      height: 100%;
    }

    #example-scanning-overlay {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      background: transparent;
      z-index: 2;
    }

    @media (min-aspect-ratio: 1/1) {
      #example-scanning-overlay .inner {
        width: 50vh;
        height: 50vh;
      }
    }

    @media (max-aspect-ratio: 1/1) {
      #example-scanning-overlay .inner {
        width: 80vw;
        height: 80vw;
      }
    }

    #example-scanning-overlay .inner {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;

      background:
        linear-gradient(to right, white 10px, transparent 10px) 0 0,
        linear-gradient(to right, white 10px, transparent 10px) 0 100%,
        linear-gradient(to left, white 10px, transparent 10px) 100% 0,
        linear-gradient(to left, white 10px, transparent 10px) 100% 100%,
        linear-gradient(to bottom, white 10px, transparent 10px) 0 0,
        linear-gradient(to bottom, white 10px, transparent 10px) 100% 0,
        linear-gradient(to top, white 10px, transparent 10px) 0 100%,
        linear-gradient(to top, white 10px, transparent 10px) 100% 100%;
      background-repeat: no-repeat;
      background-size: 40px 40px;
    }

    #example-scanning-overlay.hidden {
      display: none;
    }

    #example-scanning-overlay img {
      opacity: 1;
      width: 90%;
      align-self: center;
    }

    #example-scanning-overlay h3 {
      position: absolute;
      top: 77%;
      align-self: center;
      color: white;
    }

    #example-scanning-overlay .inner .scanline {
      position: absolute;
      width: 100%;
      height: 10px;
      background: white;
      animation: move 2s linear infinite;
    }

    @keyframes move {

      0%,
      100% {
        top: 0%
      }

      50% {
        top: calc(100% - 10px)
      }
    }

    #redirectbtn {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 90%;
      left: 50%;
      width: 70%;
      height: auto;
      visibility: hidden;
      z-index: 99999;
    }

    #logo {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 10%;
      left: 50%;
      width: auto;
      height: 70px;
      visibility: hidden;
      z-index: 99999;
    }

    #informationIcon {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 10%;
      left: 78%;
      width: auto;
      height: 40px;
      visibility: hidden;
      z-index: 99999;
    }

    #reloadIcon {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 10%;
      left: 90%;
      width: auto;
      height: 42px;
      visibility: hidden;
      z-index: 99999;
    }

    #activateCardIcon1 {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 82%;
      left: 50%;
      width: 70%;
      height: auto;
      visibility: hidden;
      z-index: 99999;
    }

    #checkYourBenefitsIcon {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 89%;
      left: 50%;
      width: 70%;
      height: auto;
      visibility: hidden;
      z-index: 99999;
    }

    #activateYourCardIcon {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 90%;
      left: 50%;
      width: 70%;
      height: auto;
      visibility: hidden;
      z-index: 99999;
    }

    #benefitsIcon {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 10%;
      left: 35%;
      width: 50%;
      height: auto;
      visibility: hidden;
      z-index: 99999;
    }

    #cameraNotPermitted {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 50%;
      left: 50%;
      width: auto;
      height: 45%;
      visibility: hidden;
      z-index: 99999;
    }

    #privacyPolicy {
      transform: translate(-50%, -50%);
      position: absolute;
      top: 50%;
      left: 50%;
      width: auto;
      height: 45%;
      visibility: hidden;
      z-index: 99999;
    }
  </style>
</head>

<body>
  <div class="example-container">
    <div id="example-scanning-overlay" class="hidden">
      <div class="inner">
        <img src="./assets/CreditCard.png" />
        <div class="scanline"></div>
      </div>
    </div>
    <img id="redirectbtn" src="./assets/RedirectBtn.png" onclick="redirectBtnClick()" />
    <img id="logo" src="./assets/RAKIslamic-Logo.png" />
    <img id="cameraNotPermitted" src="./assets/CameraNotPermitted.png" />
    <img id="informationIcon" src="./assets/informationIcon.png" onclick="informationCard()"/>
    <img id="reloadIcon" src="./assets/reloadIcon.png" onclick="refreshPage()"/>
    <img id="activateCardIcon1" src="./assets/activateCardIcon1.png" onclick="activateCardIcon1()"/>
    <img id="checkYourBenefitsIcon" src="./assets/checkYourBenefitsIcon.png" onclick="checkYourBenefitsIcon()"/>
    <img id="activateYourCardIcon" src="./assets/activateYourCard.png" onclick="activateCardIcon1()"/>
    <img id="benefitsIcon" src="./assets/Benefits.png" />
    <img id="privacyPolicy" src="./assets/PrivacyPolicy.png" onclick="hideInformationCard()" />

    <a-scene
      mindar-image="imageTargetSrc: ./assets/CreditCard.mind; filterMinCF:0.0001; filterBeta: 0.001; showStats: false; uiScanning: #example-scanning-overlay;"
      loading-screen="dotsColor: red; backgroundColor: black" gesture-detector color-space="sRGB"
      renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false">
      <a-assets>
        <!-- <a-asset-item id="avatarModel" src="./assets/BehrouzBiryaniOptimized.gltf" 
        crossorigin="anonymous" preload="auto"></a-asset-item> -->
        <img id="ccimage" src="./assets/BgCard.png">
        <img id="ccimageBlack" src="./assets/BgCardBlack.png">
        <img id="bgimage" src="./assets/BgGradient.png">
        <img id="benefitsDetails" src="./assets/benefitsDetails.png">

        <img id="B0" src="./assets/B0.png">
        <img id="B1" src="./assets/B1Icon.png">
        <img id="B2" src="./assets/B2Icon.png">
        <img id="B3" src="./assets/B3Icon.png">
        <img id="B4" src="./assets/B4Icon.png">
        <img id="B5" src="./assets/B5Icon.png">
        <img id="B6" src="./assets/B6Icon.png">

        <img id="B1GG" src="./assets/B1GG.png">
        <img id="B2GG" src="./assets/B2GG.png">
        <img id="B3GG" src="./assets/B3GG.png">
        <img id="B4GG" src="./assets/B4GG.png">
        <img id="B5GG" src="./assets/B5GG.png">
        <img id="B6GG" src="./assets/B6GG.png">

        <img id="B1RG" src="./assets/B1RG.png">
        <img id="B2RG" src="./assets/B2RG.png">
        <img id="B3RG" src="./assets/B3RG.png">
        <img id="B4RG" src="./assets/B4RG.png">
        <img id="B5RG" src="./assets/B5RG.png">
        <img id="B6RG" src="./assets/B6RG.png">

        <img id="B1Text" src="./assets/B1Text.png">
        <img id="B2Text" src="./assets/B2Text.png">
        <img id="B3Text" src="./assets/B3Text.png">
        <img id="B4Text" src="./assets/B4Text.png">
        <img id="B5Text" src="./assets/B5Text.png">
        <img id="B6Text" src="./assets/B6Text.png">
        
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;" raycaster="far: ${customFields.libVersion}; objects: .clickable"></a-camera>


      <a-entity id="aentity" mytarget mindar-image-target="targetIndex: 0" class="clickable">
        <a-plane id="bgImagePlane" src="#bgimage" material="transparent: true; opacity: 0" position="0 0 0" height="2" width="2" rotation="0 0 0"
          animation="property: opacity; from: 0.0; to: 1.0; loop: false; dur: 1600; autoplay: false; startEvents: bganimstart"></a-plane>
        <a-plane id="ccImagePlane" src="#ccimage" visible="true" click-detector material="transparent: true" position="0 0 0" height="2" width="2" rotation="0 0 0"></a-plane>
        <a-plane id="ccImageBlackPlane" src="#ccimageBlack" visible="false" click-detector material="transparent: true" position="0 0 0" height="2" width="2" rotation="0 0 0"></a-plane>
        
        <!-- Benefits Dots Plane -->
        <a-plane id="B0Plane" visible="false" src="#B0" material="transparent: true" 
                 position="0 0 0" height="2.3" width="2.3" rotation="0 0 0"></a-plane>

        <!-- Green Gradients -->
        <a-plane id="B1GGPlane" visible="false" src="#B1GG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B2GGPlane" visible="false" src="#B2GG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B3GGPlane" visible="false" src="#B3GG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B4GGPlane" visible="false" src="#B4GG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B5GGPlane" visible="false" src="#B5GG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B6GGPlane" visible="false" src="#B6GG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>

        <!-- Red Gradients -->
        <a-plane id="B1RGPlane" visible="false" src="#B1RG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B2RGPlane" visible="false" src="#B2RG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B3RGPlane" visible="false" src="#B3RG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B4RGPlane" visible="false" src="#B4RG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B5RGPlane" visible="false" src="#B5RG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>
        <a-plane id="B6RGPlane" visible="false" src="#B6RG" material="transparent: true" 
                 position="0 0 0.01" height="2.3" width="2.3" rotation="0 0 0"></a-plane>

        <!-- Text Planes -->
        <a-plane id="B1TextPlane" visible="false" src="#B1Text" material="transparent: true; alphaTest: 0.1"
                 position="0 0 0.012" height="2" width="2" rotation="0 0 0"></a-plane>
        <a-plane id="B2TextPlane" visible="false" src="#B2Text" material="transparent: true; alphaTest: 0.1"
                 position="0 0 0.012" height="2" width="2" rotation="0 0 0"></a-plane>
        <a-plane id="B3TextPlane" visible="false" src="#B3Text" material="transparent: true; alphaTest: 0.1"
                 position="0 0 0.012" height="2" width="2" rotation="0 0 0"></a-plane>
        <a-plane id="B4TextPlane" visible="false" src="#B4Text" material="transparent: true; alphaTest: 0.1"
                 position="0 0 0.012" height="2" width="2" rotation="0 0 0"></a-plane>
        <a-plane id="B5TextPlane" visible="false" src="#B5Text" material="transparent: true; alphaTest: 0.1"
                 position="0 0 0.012" height="2" width="2" rotation="0 0 0"></a-plane>
        <a-plane id="B6TextPlane" visible="false" src="#B6Text" material="transparent: true; alphaTest: 0.1"
                 position="0 0 0.012" height="2" width="2" rotation="0 0 0"></a-plane>
           
        <!-- Benefits Icons Planes -->
        <a-plane id="B1Plane" visible="false" src="#B1" material="transparent: true" class="clickable"
                 position="-0.8 0.13 0.011" height="0.3" width="0.3" rotation="0 0 0"></a-plane>
        <a-plane id="B2Plane" visible="false" src="#B2" material="transparent: true" class="clickable"
                 position="-0.66 -0.36 0.011" height="0.3" width="0.25" rotation="0 0 0"></a-plane>
        <a-plane id="B3Plane" visible="false" src="#B3" material="transparent: true" class="clickable"
                 position="-0.26 -0.64 0.011" height="0.3" width="0.32" rotation="0 0 0"></a-plane>
        <a-plane id="B4Plane" visible="false" src="#B4" material="transparent: true" class="clickable" 
                 position="0.28 -0.64 0.011" height="0.3" width="0.25 rotation="0 0 0"></a-plane>
        <a-plane id="B5Plane" visible="false" src="#B5" material="transparent: true" class="clickable"
                 position="0.65 -0.36 0.011" height="0.3" width="0.23" rotation="0 0 0"></a-plane>
        <a-plane id="B6Plane" visible="false" src="#B6" material="transparent: true" class="clickable"
                 position="0.8 0.13 0.011" height="0.3" width="0.25" rotation="0 0 0"></a-plane>


      </a-entity>
    </a-scene>

  </div>

  <script>
    ; (function () {
      var src = 'https://cdnjs.cloudflare.com/ajax/libs/eruda/2.4.1/eruda.min.js';
      if (!/eruda=true/.test(window.location) && localStorage.getItem('active-eruda') != 'true') return;
      document.write('<scr' + 'ipt src="' + src + '"></scr' + 'ipt>');
      document.write('<scr' + 'ipt>eruda.init();</scr' + 'ipt>');
    })();

    var redirectbtn = document.getElementById('redirectbtn')
    const sceneEl = document.querySelector('a-scene');
    const arSystem = sceneEl.systems["mindar-image-system"];

    if ('mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices) {
      console.log("Let's get this party started!!!")
    }

    var constraints = {
      video: true,
      audio: false
    }

    function hideAllTextPlanes() {
      document.getElementById('B1TextPlane').setAttribute('visible', false)
      document.getElementById('B2TextPlane').setAttribute('visible', false)
      document.getElementById('B3TextPlane').setAttribute('visible', false)
      document.getElementById('B4TextPlane').setAttribute('visible', false)
      document.getElementById('B5TextPlane').setAttribute('visible', false)
      document.getElementById('B6TextPlane').setAttribute('visible', false)

      document.getElementById('ccImagePlane').setAttribute('visible', false)
      document.getElementById('ccImageBlackPlane').setAttribute('visible', true)
    }

    function turnGreenGradientsVisible() {
      document.getElementById('B1RGPlane').setAttribute('visible', false)
      document.getElementById('B2RGPlane').setAttribute('visible', false)
      document.getElementById('B3RGPlane').setAttribute('visible', false)
      document.getElementById('B4RGPlane').setAttribute('visible', false)
      document.getElementById('B5RGPlane').setAttribute('visible', false)
      document.getElementById('B6RGPlane').setAttribute('visible', false)

      document.getElementById('B1GGPlane').setAttribute('visible', true)
      document.getElementById('B2GGPlane').setAttribute('visible', true)
      document.getElementById('B3GGPlane').setAttribute('visible', true)
      document.getElementById('B4GGPlane').setAttribute('visible', true)
      document.getElementById('B5GGPlane').setAttribute('visible', true)
      document.getElementById('B6GGPlane').setAttribute('visible', true)
    }


    // BENEFITS CLICK DETECTION START
    
    document.getElementById('B1Plane').addEventListener("click", event => {
      console.log('B1 Tapped')
      hideAllTextPlanes()
      document.getElementById('B1TextPlane').setAttribute('visible', true)
      turnGreenGradientsVisible()
      document.getElementById('B1GGPlane').setAttribute('visible', false)
      document.getElementById('B1RGPlane').setAttribute('visible', true)
    })
    document.getElementById('B2Plane').addEventListener("click", event => {
      console.log('B2 Tapped')
      hideAllTextPlanes()
      document.getElementById('B2TextPlane').setAttribute('visible', true)
      turnGreenGradientsVisible()
      document.getElementById('B2GGPlane').setAttribute('visible', false)
      document.getElementById('B2RGPlane').setAttribute('visible', true)
    })
    document.getElementById('B3Plane').addEventListener("click", event => {
      console.log('B3 Tapped')
      hideAllTextPlanes()
      document.getElementById('B3TextPlane').setAttribute('visible', true)
      turnGreenGradientsVisible()
      document.getElementById('B3GGPlane').setAttribute('visible', false)
      document.getElementById('B3RGPlane').setAttribute('visible', true)
    })
    document.getElementById('B4Plane').addEventListener("click", event => {
      console.log('B4 Tapped')
      hideAllTextPlanes()
      document.getElementById('B4TextPlane').setAttribute('visible', true)
      turnGreenGradientsVisible()
      document.getElementById('B4GGPlane').setAttribute('visible', false)
      document.getElementById('B4RGPlane').setAttribute('visible', true)
    })
    document.getElementById('B5Plane').addEventListener("click", event => {
      console.log('B5 Tapped')
      hideAllTextPlanes()
      document.getElementById('B5TextPlane').setAttribute('visible', true)
      turnGreenGradientsVisible()
      document.getElementById('B5GGPlane').setAttribute('visible', false)
      document.getElementById('B5RGPlane').setAttribute('visible', true)
    })
    document.getElementById('B6Plane').addEventListener("click", event => {
      console.log('B6 Tapped')
      hideAllTextPlanes()
      document.getElementById('B6TextPlane').setAttribute('visible', true)
      turnGreenGradientsVisible()
      document.getElementById('B6GGPlane').setAttribute('visible', false)
      document.getElementById('B6RGPlane').setAttribute('visible', true)
    })
    // BENEFITS CLICK DETECTION START


    setInterval(function() {
      navigator.permissions.query({ name: 'camera' }).then(function (result) {
        // alert(result.state);
        if (result.state === 'granted') {
          //permission has already been granted, no prompt is shown
        } else if (result.state === 'prompt') {
          //there's no peristent permission registered, will be showing the prompt
        } else if (result.state === 'denied') {
        //permission has been denied
        window.navigator.mediaDevices.getUserMedia(constraints)
        .then((stream) => {
            console.log('Camera Access Permitted')
          })
          .catch((err) => {
            console.log('Camera Access Denied')
            document.getElementById('cameraNotPermitted').style.visibility = 'visible'
            setTimeout(function () {
              window.location.reload();
            }, 5000)
          });
        }
      });
    },1000)
      

    sceneEl.addEventListener("arReady", (event) => {
      console.log("MindAR is ready")
      document.getElementById('logo').style.visibility = 'visible'
    });

    function redirectBtnClick() {
      console.log("Redirecting...")
      // window.location.href = "https://www.behrouzbiryani.com/Raan-AR?utm_source=qr&utm_medium=flyer&utm_id=Raan-AR"
      window.open("https://www.behrouzbiryani.com/Raan-AR?utm_source=qr&utm_medium=flyer&utm_id=Raan-AR", "_blank");
    }

    function activateCardIcon1() {
      console.log("Redirect")
      window.location.href = "https://www.rakbank.ae/en/islamic/personal/cards/credit-cards/watani-credit-card";
    }
    function refreshPage() {
      console.log("Refresh")
      window.location.reload();
    }
    function informationCard() {
      console.log("informationCard")
      document.getElementById('privacyPolicy').style.visibility = 'visible'
    }
    function hideInformationCard() {
      console.log("informationCard")
      document.getElementById('privacyPolicy').style.visibility = 'hidden'
    }

    var animateBgGradient = (function() {
      var executed = false;
      return function() {
        if (!executed) {
          executed = true;
          document.getElementById('bgImagePlane').emit('bganimstart')
        }
      };
    })();

    var initOptionsScreen = (function() {
      var executed = false;
      return function() {
        if (!executed) {
          executed = true;
          document.getElementById('reloadIcon').style.visibility = "visible"
          document.getElementById('informationIcon').style.visibility = "visible"
          document.getElementById('activateCardIcon1').style.visibility = "visible"
          document.getElementById('checkYourBenefitsIcon').style.visibility = "visible"
        }
      };
    })();


    var initCheckOurBanefits = (function() {
      var executed = false;
      return function() {
        if (!executed) {
          executed = true;
          document.getElementById('activateCardIcon1').style.visibility = "hidden"
          document.getElementById('checkYourBenefitsIcon').style.visibility = "hidden"
          document.getElementById('activateYourCardIcon').style.visibility = "visible"
          document.getElementById('benefitsIcon').style.visibility = "visible"
          document.getElementById('B0Plane').setAttribute('visible', true)
          turnGreenGradientsVisible()
          document.getElementById('B1Plane').setAttribute('visible', true)
          document.getElementById('B2Plane').setAttribute('visible', true)
          document.getElementById('B3Plane').setAttribute('visible', true)
          document.getElementById('B4Plane').setAttribute('visible', true)
          document.getElementById('B5Plane').setAttribute('visible', true)
          document.getElementById('B6Plane').setAttribute('visible', true)
        }
      };
    })();

    function checkYourBenefitsIcon() {
      console.log("BenefitsOpen")
      initCheckOurBanefits()

    }


    AFRAME.registerComponent('mytarget', {
      init: function () {
        this.el.addEventListener('targetFound', event => {
          document.getElementById('example-scanning-overlay').style.display = 'none'
          document.getElementById('logo').style.visibility = "hidden"
          animateBgGradient()
          


          console.log("target found");

          setTimeout(function () {
            initOptionsScreen()
          }, 2000)
        });
        this.el.addEventListener('targetLost', event => {
          console.log("target lost");
          document.getElementById('example-scanning-overlay').style.display = 'flex'
        });
      }
    });
  </script>
</body>

</html>